---
title: "Psy a Blechy"
date: "2025-10-07"
updated: "2025-12-06"
description: "O skákání blech mezi 2 psy aneb Ehrenfestův model"
draft: false
categories: ["Mikrostav","Makrostav", "Přednáška 1" ]
# image: "image.jpg"
pdflink: "[![PDF](images/pdf_icon.png){width=60px}](posts/p1_mikro_makro_stavy/psy_blechy.pdf)"

engine: julia

lang: cs

format:
    typst:
        output-file: "psy_blechy"
        output-ext: "pdf"
        engine: typst
---

# Model psů a blech

## Pravidla simulace 

Představme si 2 psy (pravý a levý pes) a 10 očíslovaných blech. Na počátku
všechny blechy sedí na levém psu. Pak vylosujeme náhodné číslo od 1 do 10 a
blecha vylosovaného čísla přeskočí na druhého psa. Pak pokračujeme s druhým
losování přeskokem blechy atd.

```{dot}
//| file: psy_a_blechy.dot
//| fig-width: 4.2
//| fig-height: 6.3
``` 

Popsaný model vyvoje počtu blech na pravém psu se nazývá Ehrenfestův (urnový) model.
Analyzuje se v něm počet blech na pravém psu $R_n$ po $n$ krocích.

Simulaci tohoto procesu ukazuje následující kód:
```{julia}
#| code-fold: false
using Random, Plots, Plots.PlotMeasures

function onerun(; num_particles = 10, left_side = 10, num_steps = 100)
	R = Vector{Int}(undef, num_steps + 1)
	right_side = num_particles - left_side

	for n in 1:(num_steps+1)
		R[n] = right_side
		if rand() * num_particles < left_side
			left_side -= 1
			right_side += 1
		else
			right_side -= 1
			left_side += 1
		end
	end
	return R
end
num_steps = 40
R = onerun(num_particles = 10, left_side = 0, num_steps = num_steps)
println(R)
```

Pokud provedeme tento pokus opakovaně získáme několik realizací tohoto procesu. 

```{julia}
#| code-fold: true
using Plots, LaTeXStrings, Plots.PlotMeasures
# Parametry simulace
num_simulations = 15      # Počet simulací
num_particles = 10       # Počet částic
num_steps = 300        # Počet časových kroků
# Nastavení grafu
ylabels = Vector{String}(undef, 2 * num_simulations)
for i in 1:num_simulations
    ylabels[2*i-1] = "[#$(i)]"
    ylabels[2*i] = "0"
end;
pl = plot(; size=(1200, 800), legend=:outerright, framestyle=:natural,
    ylim=(0, num_simulations * num_particles),
    yticks=((-(num_particles / 2)):(num_particles/2):((num_simulations-1+0.5)*(num_particles)), ylabels),
    ylabel="R[n] - počet blech na psu napravo",
    xlabel="n-časový krok", grid=:on, minorgrid=false,
    left_margin=[5mm 5mm], bottom_margin=5mm,
    title="$num_simulations simulaci s $num_steps čásovými kroky " *
          "\n$num_particles částic, na počátku  jsou na levé straně ",
)

for Nsim in 1:num_simulations
    left_side = num_particles
    R = onerun(num_particles=num_particles, left_side=num_particles, num_steps=num_steps)
    # println(R)
    pl = plot!(1:(num_steps+1), R .+ num_particles * (Nsim - 1); label="Simulace $Nsim", lw=1, show=true)
end
pl
```

## Mikrostavy a makrostavy modelu psů a blech

Podobně jako u házení kostkami lze u tohoto modelu definovat mikrostavy a marrostavy. 
Mikrostavem je vývoj počtu blech od počátečního okamžiku do n-tého časového kroku kdy pozorujeme 
makrostav $R_n$ (ten nabívá hodnot $R_n \in (0,k$), kde k je počet blech).

Celkový počet mikrostavů (možných drah od okamžiku 0 do n-tého časového kroku ) je roven:


$$
\begin{equation}
O=2^n
\end{equation}
$$

Což odpovídá možnému vývoji v každém z $n$ kroků (buď se počet blech na pravém
psu zvýší nebo sníží). Multiplicita $M$ makrostavu $R_n$  je rovna počtu kombinací
kdy v $k$ krocích z $n$ kroku blecha skočí na pravého psa.


$$
\begin{equation}
M=\binom nk=\frac{n!}{k!(n-k)!}
\end{equation}
$$



Pravděpodobnost přeskoku $p_n$ v kroku $n$  závisí na počtu blech $R_{n-1}$ v předchozím kroku:

$$
\begin{equation}
p_n^+=1-\frac{R_{n-1}}{N} \implies  R_n=R_{n-1}+1
\end{equation}
$$


$$
\begin{equation}
p_n^-=1-\frac{R_{n-1}}{N} =1-p_n^+ \implies  R_n=R_{n-1}-1
\end{equation}
$$

Co se tedy v případě modelu psů a blech liší od házení kostkami je fakt, že
jednotlivé mikrostavy mají různou pravděpodobnost. Pro výpočet pravděpodobnosti
makrostavu je nutno využít Markovovy řetězce.


