---
title: "ƒålovƒõƒçe nezlob se"
date: "2025-11-10"
updated: "2025-11-23"
description: "Anal√Ωza po≈ôad√≠ h√°zen√≠ kostkou: kdy, poprv√© padne 6-ka ?"
draft: false
categories: ["N√°hodn√° promƒõnn√°", "Semin√°≈ô2"]
# image: "image.jpg"
pdflink: "[![PDF](images/pdf_icon.png){width=60px}](posts/p2_nahodna_promenna/clovece_nezlob_se.pdf) "

html-math-method: katex
engine: python

format:
    typst:
        output-file: "clovece_nezlob_se"
        output-ext: "pdf"
---

# ƒålovƒõƒçe nezlob se - pravidlo pro postup z domeƒçku 

Hr√°ƒç m≈Ø≈æe z "domeƒçku" postoupit na prvn√≠ pole, a≈æ kdy≈æ hod√≠ hrac√≠ kostkou 6-ku.
Pokud mu nepadne musi ƒçekat na dal≈°√≠ kolo.

Jak dlouho ƒçek√° - kolikr√°t musi hodit kostkou nez postoupi z domeƒçku? 
Doba ƒçek√°n√≠  je n√°hodn√° veliƒçina s nekoneƒçnƒõ mnoho hodnotami.

# Po≈ôad√≠ hodu kdy padla prvni 6-ka jako n√°hodn√° promƒõnn√° 

## Pravdƒõpodobnost, ≈æe 6-ka padne v k-t√©m hodu 

Jak√° je pravdƒõpodobnost 6-ky v k-t√©m hodu:

* 1. hod  $\frac{1}{6}$ : hned 6-ka padla $p1=\frac{1}{6}$
* 2. hod  $\frac{5}{6}\cdot\frac{1}{6}$ : v p≈ôedchoz√≠m hodu 6-ka nepadla $p1=\frac{5}{6}$  a pak padla $p2=1\frac{1}{6}$
* 3. hod  $\frac{5}{6}\cdot\frac{5}{6}\cdot\frac{1}{6}$ : ve dvou p≈ôedchoz√≠ch hodech 6-ka nepadla $p1 \cdot p2 =\frac{5}{6} \cdot \frac{5}{6}$  a pak padla $p3=1\frac{1}{6}$
* ...
* k-t√Ω hod  $\frac{5}{6}\ldots\frac{5}{6}\cdot\frac{1}{6}$  kde je $(k-1)$ ƒçlen≈Ø $\frac{5}{6}$ (vyjad≈ôuj√≠c√≠ch, ≈æe v $(k-1)$ p≈ôedchoz√≠ch hod≈Ø 6-ka nikdy nepadla )


Pravdƒõpodobnost  prvni 6-ky v hodu k je tedy:
$$
p_k = \frac{1}{6} \cdot \left(\frac{5}{6}\right)^{i-1}
$$


**K√≥d pro v√Ωpoƒçet pravdƒõpodobnost√≠ 6-ky v k-t√©m hodu**

```{julia}
#| output: false
#| echo: true
#| code-fold: false

using DataFrames, PrettyTables, LaTeXStrings

N_max = 50
p_i = Vector{Float64}(undef, N_max)
cum_p_i = Vector{Float64}(undef, N_max)

cum_p_i[1] = 0
for i in 1:N_max
    p_i[i] = (5 / 6)^(i - 1) / 6
    cum_p_i[i] = p_i[i] + ((i > 1) ? cum_p_i[i-1] : 0)
end

```

<!-- {{< pagebreak >}} -->

```{julia}
#| echo: false
#| output: asis

println("**Tabulka pravdƒõpodobnost√≠ 6-ky v k-t√©m hodu**\n")

df = DataFrame(k=collect(1:1:N_max), p_i=p_i, cum_p_i=cum_p_i)
# Create a "separator row" with "..." in each column
sep = DataFrame(k=["..."], p_i=["..."], cum_p_i=["..."])
row_subset = vcat(first(df, 10), sep, last(df, 10))

pretty_table(
    row_subset; backend=:markdown,
    formatters=[
        fmt__printf("%d", [1]), fmt__printf("%4.5f", [2, 3])
    ],
    alignment=[:l, :c, :c],
    column_labels=[
        L"$i$", L"$p(i)$", "Kumulativn√≠ <br> souƒçet " * L"$p(i)$"
    ],
    show_row_number_column=false,
)
```



## N√°hodn√° veliƒçina K: po≈ôad√≠ hodu kdy, poprv√© padne 6-ka 

Nech≈• $K$ oznaƒçuje po≈ôad√≠ hodu kdy, prvnƒõ padla 6-ka.  

$K$ je n√°hodn√° veliƒçina nabyvajici hodnot 1,2,..., maj√≠c√≠ st≈ôedn√≠ hodnotu
oznaƒçovanou $\mathbb{E}[K]$.

$$
\mathbb{E}[K] = \sum_{i=1}^{\infty} \frac{1}{6} \cdot i \cdot \left(\frac{5}{6}\right)^{i-1}
$$

## Aproximace  $\mathbb{E}[K]$

**K√≥d pro v√Ωpoƒçet aproximace st≈ôedn√≠ hodnoty $\mathbb{E}[K]$ pomoc√≠ prvn√≠ch $N_max$ ƒçlen≈Ø posloupnosti $p(i)$**
```{julia}
#| output: false
#| echo: true
#| code-fold: false
EK_i = Vector{Float64}(undef, N_max)

cum_i_p_i = 0
for i in 1:N_max
    cum_i_p_i = cum_i_p_i + i * p_i[i]
    EK_i[i] = cum_i_p_i
end
```

```{julia}
#| echo: false
#| output: asis

println("**Tabulka k-t√° aproximace  \$\\mathbb{E}[K]\$ **\n")

df.EK_i = EK_i

# Create a "separator row" with "..." in each column
sep = DataFrame(k=["..."], p_i=["..."], cum_p_i=["..."], EK_i=["..."])
row_subset = vcat(first(df, 10), sep, last(df, 10))

pretty_table(
    select(row_subset, [:k, :p_i, :EK_i]);
    backend=:markdown,
    formatters=[
        fmt__printf("%d", [1]), fmt__printf("%4.5f", [2, 3, 4])
    ],
    alignment=[:l, :c, :c],
    column_labels=[
        L"$k$", L"$p(k)$", "k-t√° aproximace <br>" * L"$\mathbb{E}[K]$"
    ],
    show_row_number_column=false,
)
```


```{julia}
#| code-fold: true

using DataFrames, Plots, LaTeXStrings, Plots.PlotMeasures

dfg = first(df, 25)
x = 1:nrow(dfg)


# create a second axis sharing x
# Second y-axis: bar plot of P(i)
bar(
    x, dfg[!, "p_i"],
    color=:skyblue,
    alpha=0.5,
    ylims=[0, 0.18],
    yticks=0:0.03:0.18,
    ylabel="p(i)",
    label="p(i)",
    title="Konvergence st≈ôedn√≠ hodnoty E[K] z prvn√≠ch i hodnot",
    legend=:bottomright,
)


plot!(
    twinx(),  # Create a second y-axis
    x, dfg[!, "EK_i"],
    color=:red,
    xlabel="i-th aproximace",
    ylims=[0, 6],
    yticks=0:1:10,
    xticks=0:5:nrow(dfg),
    ylabel=L"$\mathbb{E}[K]$",
    label=L"$\mathbb{E}[K]$",
    legend=:top,
    left_margin=20mm,
    top_margin=15mm,
    # bottom_margin=15mm,
    right_margin=20mm,
    size=(900, 600),
    # framestyle=:box,
    grid=true,
    minorgrid=true
)

```

# Odvozeni st≈ôedn√≠ hodnoty $\mathbb{E}[K]$ n√°hodn√© veliƒçiny K

## P≈ô√≠prava 1: souƒçet geometrick√© ≈ôady 

Koneƒçn√° geometrick√° ≈ôada:
$$
\sum_{i=1}^{k} q^i
$$

Tato ≈ôada m√° prvn√≠ ƒçlen $q$, kvocient $q$, a obsahuje $k$ ƒçlen≈Ø. Odvozen√≠ je
jednoduch√© a elegantn√≠.

1. Zapi≈° ≈ôadu:
$$
S = q + q^2 + q^3 + \dots + q^k
$$

2. Vyn√°sob obƒõ strany kvocientem $q$:
$$
qS = q^2 + q^3 + \dots + q^{k+1}
$$

3. Odeƒçti druhou rovnici od prvn√≠:
$$
S - qS = q - q^{k+1}
$$

4. Vyj√°d≈ôi $S$:
$$
S(1 - q) = q(1 - q^k) \quad \Rightarrow \quad S = \frac{q(1 - q^k)}{1 - q}
$$

__‚úÖ V√Ωsledek:__
$$
\sum_{i=1}^{k} q^i = \frac{q(1 - q^k)}{1 - q}, \quad \text{pro } q \ne 1
$$

__üìä Nekoneƒçn√° geometrick√° ≈ôada:__

A pokud  $q \lt 1$ konverguje i nekoneƒçn√° geometrick√° ≈ôada 

$$
\sum_{i=1}^{\infty} q^i = \frac{q}{1 - q}, \quad \text{pro } |q| < 1
$$

## P≈ô√≠prava 2: souƒçet  ≈ôady s ƒçleny $i \cdot q^i$

Souƒçet ≈ôady ve tvaru:

$$
\sum_{i=1}^{\infty} i \cdot q^i
$$

1. Lze odvodit z derivace geometrick√© ≈ôady:

$$
\sum_{i=0}^{\infty} q^i = \frac{1}{1 - q}
$$

2. Kdy≈æ tuto ≈ôadu zderivujeme podle $q$, dostaneme pr√°vƒõ:

$$
\sum_{i=1}^{\infty} i \cdot q^{i-1} = \frac{1}{(1 - q)^2}
$$

3. A kdy≈æ ji vyn√°sob√≠me $q$, dostaneme vzorec:

$$
\sum_{i=1}^{\infty} i \cdot q^i = \frac{q}{(1 - q)^2}
$$

_Tento vzorec plat√≠ pouze pro$|q| < 1$, tedy kdy≈æ se jedn√° o konvergentn√≠ geometrickou ≈ôadu._

## St≈ôedn√≠ hodnota  $\mathbb{E}[K]$  

Pro geometrick√© rozdƒõlen√≠ (poƒç√≠tan√© od $i = 1$):

$$
\begin{align}
\mathbb{E}[X]  &= \sum_{i=1}^{\infty} i \cdot p \cdot (1 - p)^{i - 1} 
    &= p \cdot \frac{1}{q} \cdot  \sum_{i=1}^{\infty} i  \cdot (q)^{i} = p \cdot \frac{1}{q} \cdot \frac{q}{(1 - q)^2}
    = \frac{1}{p}
\end{align}
$$

Kde:

- $q=(1 - p)$

V na≈°em p≈ô√≠padƒõ:
$p = \frac{1}{6}$

__üìäTak≈æe st≈ôedn√≠ hodnota po≈ôad√≠ hodu do prvn√≠ 6-ky je:__

$$
\mathbb{E}[K] =6
$$ 

