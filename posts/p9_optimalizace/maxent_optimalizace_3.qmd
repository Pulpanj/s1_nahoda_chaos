---
title: "Řešení MAXENT principu pomocí optimalizace pro 3 stavy"
date: "2025-12-01"
updated: "2025-12-08"
description: "MAXENT jen s 3 kostkami pomocí optimalizace"
draft: false
categories: ["Optimalizace","Informační entropie", "Přednáška 9", "MAXENT", "Odvození"]
# image: "image.jpg"
pdflink: "[![PDF](images/pdf_icon.png){width=60px}](posts/p9_optimalizace/maxent_optimalizace_3.pdf) "

html-math-method: katex
engine: julia

lang: cs

format:
    typst:
        output-file: "maxent_optimalizace_3"
        output-ext: "pdf"
        engine: typst
---

# Pokus o řešení MAXENT principu pro syst0m s 3 stavy

Mějme systém který muže nabývat 3 mikrostavů a každý mikrostav je svázán s
"energií" ${\epsilon}_i$, pro všechny stavy $i \in (1,3)$

Pravděpodobnosti stavů $p_i$ kromě normalizační podmínky:

$$
\begin{equation}
\sum_{i=1}^3{p_i}=1
\end{equation}
$${#eq-one}

musí splňovat i podmínku (vazbu) pro pozorovanou veličinu  (makrostav) $U$:

$$
\begin{equation}
\sum_{i=1}^3{p_i  \cdot {\epsilon}_i}=U
\end{equation}
$${#eq-meanU}

V rovnovážném stavu bude systém maximální entropii: 

$$
Q=-\sum_{i=1}^3{p_i\cdot log_2(p_i)}=max
$$

## Vyloučení proměnných daných vazbami

A rovnice [-@eq-one] lze vyjádřit $p_{2}$ jako:


$$
\begin{equation}
p_2(p_1)=1-p_1-p_3(p_2)
\end{equation}
$$

A z rovnice [-@eq-meanU] lze vyjádřit $p_{N-1}$ jako: 


$$
\begin{align}
 p_{3}  \cdot {\epsilon}_3  =
   U - p_1  \cdot {\epsilon}_1 -p_2(p_1)  \cdot {\epsilon}_2 
\end{align}
$$

$$
\begin{align}
p_{3}  \cdot {\epsilon}_3  =
U - p_1  \cdot {\epsilon}_1 - 
\left( { 1-p_1-p_3 } \right) \cdot {\epsilon}_2 
\end{align}
$$

$$
\begin{equation}
p_{N}  \cdot ({\epsilon}_3- {\epsilon}_{2})
= U- {\epsilon}_{2} -
{p_i \cdot ({\epsilon}_1} + {\epsilon}_{2}) 
\end{equation}
$$


$$
\begin{equation}
p_{3}(p_1)
=\frac{\big( {p_1 \cdot ({\epsilon}_1} + {\epsilon}_{2})\big)
}
{({\epsilon}_3- {\epsilon}_{3})} 
\end{equation}
$$


## Entropie po dosazení vazeb 

$$
\begin{align}
Q(p_1)=-{p_1\cdot log_2(p_1)} \\
    - p_{2}(p_1)  \cdot log_2 \big(p_{2}(p_1) \big) \\
    - p_{3}(p_1)  \cdot log_2 \big(p_{3}(p_1) \big)
\end{align}
$$




## Parciální derivace

$$
\begin{align}
\frac{\partial}{\partial p_1}\, Q(p_1)=
\frac{\partial}{\partial p_1}\, \big(p_1 \cdot log_2(p_1) \big)\\
    -\frac{\partial}{\partial p_1}\, \big( p_{2}(p_1) \cdot log_2(p_{2}(p_1))
    \big) \\
    -\frac{\partial}{\partial p_1}\, \big(p_3(p_1) \cdot log_2(p_3(p_1))\big)
\end{align}
$$


$$
\begin{align}
\frac{\partial}{\partial p_1}\, p_3(p_1)=
\frac{
    ({\epsilon}_1 + {\epsilon}_{2})
    } {
        ({\epsilon}_3- {\epsilon}_{2})
        }
\end{align}
$$


$$
\begin{align}
\frac{\partial}{\partial p_j1}\, p_{2}(p_1)=
    -1-\frac{\partial}{\partial p_1}\, p_3(p_1) \\
= -1- \frac{
    ({\epsilon}_1 + {\epsilon}_{2})
    } {
        ({\epsilon}_3- {\epsilon}_{2})
        }
\end{align}
$$


Dosazením do parciální derivace pro $Q(p_1,...,p_{n-2})$ dle $p_j$ dostaneme:


$$
\begin{align}
\frac{\partial}{\partial p_1}\, Q(p_1)=
    -\left(\log_2 p_1 + \frac{1}{\ln 2}\right) \\
        % dP2
    - \left( 
        1- \frac{
            ({\epsilon}_1 + {\epsilon}_{2})
            } 
            {
            ({\epsilon}_3 - {\epsilon}_{2})
            }    
    \right)
    \cdot  
    \left( 
        log_2 \left(
            % P_2
            1- p_1 
            - \left( 
            %   \frac{\big( {p_1 \cdot ({\epsilon}_1} + {\epsilon}_{2})\big)}
              \frac{ {p_1 \cdot ({\epsilon}_1} + {\epsilon}_{2})}
            %  {({\epsilon}_3- {\epsilon}_{3})} 
             {({\epsilon}_3- {\epsilon}_{2})} 
            \right)
            \right)
            +\frac{1}{\ln 2}
    \right) \\
    % dP3
    -  \frac{
            ({\epsilon}_1 + {\epsilon}_{2})
            } 
            {
            ({\epsilon}_3- {\epsilon}_{2})
            }    
    % \right)
    \cdot  
    \left( 
        log_2 \left(
        %    P3
        \frac{\ {p_1 \cdot ({\epsilon}_1} + {\epsilon}_{2}))}
             {({\epsilon}_3- {\epsilon}_{2})} 
            \right)
            +\frac{1}{\ln 2}
    \right) 
\end{align}
$$


### Solving the stationarity condition for p1

You corrected the derivative to:
$$
\frac{\partial}{\partial p_1} Q(p_1)=
    -\left(\log_2 p_1 + \frac{1}{\ln 2}\right)
    - \left( 
        1- \frac{{\epsilon}_1 + {\epsilon}_{2}}{{\epsilon}_3 - {\epsilon}_{2}}
    \right)
\left( 
        \log_2 \left(
            1- p_1 
            - \frac{p_1 {\epsilon}_1 + {\epsilon}_{2}}{{\epsilon}_3- {\epsilon}_{2}} 
            \right)
            +\frac{1}{\ln 2}
    \right)
    -  \frac{{\epsilon}_1 + {\epsilon}_{2}}{{\epsilon}_3- {\epsilon}_{2}}
\left( 
        \log_2 \left(
        \frac{p_1 {\epsilon}_1 + {\epsilon}_{2}} {{\epsilon}_3- {\epsilon}_{2}} 
            \right)
            +\frac{1}{\ln 2}
    \right).
$$

Define
$$
\begin{align}
a \coloneqq \frac{\epsilon_1+\epsilon_2}{\epsilon_3-\epsilon_2}, \\
P_2(p_1) \coloneqq 1 - p_1 - \frac{p_1\epsilon_1+\epsilon_2}{\epsilon_3-\epsilon_2}, \\
P_3(p_1) \coloneqq \frac{p_1\epsilon_1+\epsilon_2}{\epsilon_3-\epsilon_2}.
\end{align}
$$

Setting \(\frac{\partial Q}{\partial p_1}=0\) and multiplying both sides by \(-1\) gives:
$$
\big(\log_2 p_1 + \tfrac{1}{\ln 2}\big)
    + (1-a)\big(\log_2 P_2 + \tfrac{1}{\ln 2}\big)
    + a\big(\log_2 P_3 + \tfrac{1}{\ln 2}\big)=0.
$$

Group the constant terms:
$$
\log_2 p_1 + (1-a)\log_2 P_2 + a\log_2 P_3 + \frac{2}{\ln 2}=0.
$$

Combine the logarithms:
$$
\log_2\!\big(p_1\, P_2^{\,1-a}\, P_3^{\,a}\big) = -\frac{2}{\ln 2}.
$$

Exponentiate base 2 (using \(2^{c}=e^{c\ln 2}\)):
$$
p_1\, P_2^{\,1-a}\, P_3^{\,a} \;=\; e^{-2}.
$$


### Explicit form in terms of ε parameters

Let $d = \epsilon_3-\epsilon_2$ (so $a=(\epsilon_1+\epsilon_2)/d$). Then
$$
P_2 = 1 - p_1\Big(1 + \frac{\epsilon_1}{d}\Big) - \frac{\epsilon_2}{d}, 
\qquad
P_3 = \frac{p_1\epsilon_1+\epsilon_2}{d}.
$$

The stationarity condition becomes the implicit equation in \(p_1\):
$$
p_1 \left(1 - p_1\Big(1 + \frac{\epsilon_1}{d}\Big) - \frac{\epsilon_2}{d}\right)^{1-a}
\left(\frac{p_1\epsilon_1+\epsilon_2}{d}\right)^{a}
= e^{-2}.
$$

This generally does not admit a closed-form solution for \(p_1\) and is solved numerically.

